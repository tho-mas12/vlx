<!DOCTYPE html>
<html lang="en">
<head>
    <title>Admin - VLX</title>
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-secondary px-4 fixed-top">
  <a class="navbar-brand fw-bold" href="index.html">OLX Sell/Buy</a>

  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse justify-content-end" id="navMenu">
    <ul class="navbar-nav">
      <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
      <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
      <li class="nav-item"><a class="nav-link" href="product.html">Product</a></li>
      <li class="nav-item"><a class="nav-link" href="user-login.html">User Login</a></li>
      <li class="nav-item"><a class="nav-link active" href="admin.html">Admin Login</a></li>
    </ul>
  </div>
</nav>

<div style="height:70px;"></div>
<div class="container my-5">
  <h3>Admin</h3>

  <!-- Admin login card -->
  <div class="card mb-4" id="adminCard">
    <div class="card-body" style="max-width:480px;">
      <form id="adminForm">
        <div class="mb-3">
          <label for="adminEmail" class="form-label">Admin Email</label>
          <input id="adminEmail" type="email" class="form-control" placeholder="admin@example.com" required>
        </div>
        <div class="mb-3">
          <label for="adminPassword" class="form-label">Password</label>
          <input id="adminPassword" type="password" class="form-control" placeholder="Password" required>
        </div>
        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-primary">Login</button>
          <button type="reset" class="btn btn-secondary">Reset</button>
        </div>
      </form>
      <div id="adminAlert" class="mt-3"></div>
    </div>
  </div>

  <!-- Dashboard (hidden until admin logs in) -->
  <div id="dashboard" class="d-none">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4 class="m-0">Login History</h4>
      <div>
        <button id="logoutBtn" class="btn btn-outline-secondary btn-sm">Logout</button>
      </div>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>User ID</th>
            <th>Email</th>
            <th>Login Time</th>
          </tr>
        </thead>
        <tbody id="historyTableBody">
          <!-- rows populated by JS -->
        </tbody>
      </table>
    </div>
  </div>

</div>

<footer class="bg-dark text-white text-center p-3 mt-5">
  Â© 2025 OLX Clone - Designed by Thomas Darwin J
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  (function(){
    const adminForm = document.getElementById('adminForm');
    const dashboard = document.getElementById('dashboard');
    const historyBody = document.getElementById('historyTableBody');
    const adminAlert = document.getElementById('adminAlert');
    const logoutBtn = document.getElementById('logoutBtn');

    const ADMIN_EMAIL = 'admin@email.com';
    const ADMIN_PASS = 'admin';

    function escapeHtml(s){
      return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;');
    }

    function renderHistory(arr){
      if(!Array.isArray(arr)) arr = [];
      historyBody.innerHTML = arr.map(item=>{
        return `<tr><td>${escapeHtml(item.id)}</td><td>${escapeHtml(item.email)}</td><td>${escapeHtml(item.time)}</td></tr>`;
      }).join('');
    }

    function loadHistory(){
      let arr = [];
      try{ arr = JSON.parse(localStorage.getItem('loginHistory')) || []; }catch(e){ arr = []; }
      if(!arr || arr.length === 0){
        arr = [
          {id:1, email:'user1@gmail.com', time:'10:30 AM'},
          {id:2, email:'user2@gmail.com', time:'11:15 AM'}
        ];
        localStorage.setItem('loginHistory', JSON.stringify(arr));
      }
      renderHistory(arr);
    }

    function showAlert(msg, type='danger'){
      adminAlert.innerHTML = `<div class="alert alert-${type} p-2" role="alert">${escapeHtml(msg)}</div>`;
    }

    adminForm.addEventListener('submit', function(e){
      e.preventDefault();
      const email = document.getElementById('adminEmail').value.trim();
      const pwd = document.getElementById('adminPassword').value;
      if(!email || !pwd){ showAlert('Enter email and password.'); return; }
      if(email === ADMIN_EMAIL && pwd === ADMIN_PASS){
        sessionStorage.setItem('adminLoggedIn','1');
        adminAlert.innerHTML = '';
        document.getElementById('adminCard').classList.add('d-none');
        dashboard.classList.remove('d-none');
        loadHistory();
      } else {
        showAlert('Invalid admin credentials.');
      }
    });

    logoutBtn.addEventListener('click', function(){
      sessionStorage.removeItem('adminLoggedIn');
      dashboard.classList.add('d-none');
      document.getElementById('adminCard').classList.remove('d-none');
    });

    // auto-show dashboard if already logged in this session
    if(sessionStorage.getItem('adminLoggedIn')){
      document.getElementById('adminCard').classList.add('d-none');
      dashboard.classList.remove('d-none');
      loadHistory();
    }

  })();
</script>
</body>
</html>
